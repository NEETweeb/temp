
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Manual Install &#8212; Netmaker 0.24.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/material.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Netclient" href="netclient.html" />
    <link rel="prev" title="Install" href="install.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=blue data-md-color-accent=teal>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#manual-install" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="index.html" title="Netmaker 0.24.0 documentation"
           class="md-header-nav__button md-logo">
          
            <i class="md-icon">&#xe869</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Netmaker Docs</span>
          <span class="md-header-nav__topic"> Manual Install </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder=""Search""
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/gravitl/netmaker/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Netmaker
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = ""versions.json"",
        target_loc = "../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">Netmaker 0.24.0 documentation</a></li>
          <li class="md-tabs__item"><a href="getting-started.html" class="md-tabs__link">Getting Started</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="index.html" title="Netmaker 0.24.0 documentation" class="md-nav__button md-logo">
      
        <i class="md-icon">&#xe869</i>
      
    </a>
    <a href="index.html"
       title="Netmaker 0.24.0 documentation">Netmaker Docs</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/gravitl/netmaker/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Netmaker
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="about.html" class="md-nav__link">About</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="getting-started.html" class="md-nav__link">Getting Started</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="install.html" class="md-nav__link">Install</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Manual Install </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Manual Install</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#manual-install--page-root" class="md-nav__link">Manual Install</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#important-notes" class="md-nav__link">Important Notes</a>
        </li>
        <li class="md-nav__item"><a href="#prerequisites" class="md-nav__link">0. Prerequisites</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#server" class="md-nav__link">Server</a>
        </li>
        <li class="md-nav__item"><a href="#domain" class="md-nav__link">Domain</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#prepare-dns" class="md-nav__link">1. Prepare DNS</a>
        </li>
        <li class="md-nav__item"><a href="#install-dependencies" class="md-nav__link">2. Install Dependencies</a>
        </li>
        <li class="md-nav__item"><a href="#open-firewall" class="md-nav__link">3. Open Firewall</a>
        </li>
        <li class="md-nav__item"><a href="#prepare-mq" class="md-nav__link">4. Prepare MQ</a>
        </li>
        <li class="md-nav__item"><a href="#install-netmaker" class="md-nav__link">5. Install Netmaker</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#prepare-docker-compose" class="md-nav__link">Prepare Docker Compose</a>
        </li>
        <li class="md-nav__item"><a href="#extra-steps-for-pro" class="md-nav__link">Extra Steps for Pro</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#start-netmaker" class="md-nav__link">6. Start Netmaker</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="netclient.html" class="md-nav__link">Netclient</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="advanced-client-install.html" class="md-nav__link">Advanced Client Installation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="server-installation.html" class="md-nav__link">Advanced Server Installation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="oauth.html" class="md-nav__link">Integrating OAuth</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="oauth.html#configuring-user-permissions" class="md-nav__link">Configuring User Permissions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="getting-started.html#setup" class="md-nav__link">Setup</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="getting-started.html#create-a-network" class="md-nav__link">Create a Network</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="getting-started.html#create-a-key" class="md-nav__link">Create a Key</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="getting-started.html#deploy-nodes" class="md-nav__link">Deploy Nodes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="getting-started.html#manage-nodes-hosts" class="md-nav__link">Manage Nodes/Hosts</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="getting-started.html#uninstalling-the-netclient" class="md-nav__link">Uninstalling the netclient</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="getting-started.html#uninstalling-netmaker" class="md-nav__link">Uninstalling Netmaker</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="features.html" class="md-nav__link">Features</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pro/index.html" class="md-nav__link">Netmaker Professional</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="upgrades.html" class="md-nav__link">Upgrades</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="how-to-guides.html" class="md-nav__link">How-to-Guides</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="references.html" class="md-nav__link">References</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="license.html" class="md-nav__link">License</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="conduct.html" class="md-nav__link">Code of Conduct</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#manual-install--page-root" class="md-nav__link">Manual Install</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#important-notes" class="md-nav__link">Important Notes</a>
        </li>
        <li class="md-nav__item"><a href="#prerequisites" class="md-nav__link">0. Prerequisites</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#server" class="md-nav__link">Server</a>
        </li>
        <li class="md-nav__item"><a href="#domain" class="md-nav__link">Domain</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#prepare-dns" class="md-nav__link">1. Prepare DNS</a>
        </li>
        <li class="md-nav__item"><a href="#install-dependencies" class="md-nav__link">2. Install Dependencies</a>
        </li>
        <li class="md-nav__item"><a href="#open-firewall" class="md-nav__link">3. Open Firewall</a>
        </li>
        <li class="md-nav__item"><a href="#prepare-mq" class="md-nav__link">4. Prepare MQ</a>
        </li>
        <li class="md-nav__item"><a href="#install-netmaker" class="md-nav__link">5. Install Netmaker</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#prepare-docker-compose" class="md-nav__link">Prepare Docker Compose</a>
        </li>
        <li class="md-nav__item"><a href="#extra-steps-for-pro" class="md-nav__link">Extra Steps for Pro</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#start-netmaker" class="md-nav__link">6. Start Netmaker</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="manual-install">
<h1 id="manual-install--page-root">Manual Install<a class="headerlink" href="#manual-install--page-root" title="Permalink to this headline">¶</a></h1>
<section id="important-notes">
<h2 id="important-notes">Important Notes<a class="headerlink" href="#important-notes" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p><strong>WE RECOMMEND USING THE NM-QUICK SCRIPT INSTEAD OF THIS GUIDE. Our docker-compose files have changed sizeably and the install script now uses a different process to obtain certificates. The script can be found</strong> <a class="reference external" href="https://github.com/gravitl/netmaker#get-started-in-5-minutes">on GitHub</a> <strong>(raw script</strong> <a class="reference external" href="https://raw.githubusercontent.com/gravitl/netmaker/master/scripts/nm-quick.sh">here</a> <strong>). If you would like to install netmaker manually, You can use the instructions below.</strong></p></li>
<li><p>Due to the high volume of installations, the auto-generated domain has been rate-limited by the certificate provider. For this reason, we <strong>strongly recommend</strong> using your own domain. Using the auto-generated domain may lead to a failed installation due to rate limiting.</p></li>
<li><p>This guide is just a manual version of the steps performed by that script, and is therefore more prone to error.</p></li>
<li><p>You must decide if you are installing the Pro version of Netmaker or the Community version. We recommend Pro because of its substantial free limits, but it does require <a class="reference external" href="https://app.netmaker.io">an account</a>.</p></li>
<li><p>If deploying to DigitalOcean, you should use the <a class="reference external" href="https://marketplace.digitalocean.com/apps/netmaker">DigitalOcean 1-Click</a>, which uses the interactive script.</p></li>
<li><p>This instance will not be HA. However, it should comfortably handle 100+ concurrent clients and support the most common use cases.</p></li>
<li><p>For information about deploying more advanced configurations, see the <a class="reference internal" href="server-installation.html"><span class="doc">Advanced Installation</span></a> docs.</p></li>
</ol>
</section>
<section id="prerequisites">
<h2 id="prerequisites">0. Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<section id="server">
<h3 id="server">Server<a class="headerlink" href="#server" title="Permalink to this headline">¶</a></h3>
<p>All components of Netmaker can be run on a single server (Virtual Machine or Bare Metal). Here some recommendations for setting up the server:</p>
<ul class="simple">
<li><p>We <strong>highly recommend</strong> that Netmaker be deployed in a dedicated networking environment. It should not share a local network with the clients which it will be managing. This can cause routing issues.</p></li>
<li><p>The machine should have a public, static IP address</p></li>
<li><p>The machine should have at least 1GB RAM and 1 CPU (2GB RAM preferred for production installs)</p></li>
<li><p>2GB+ of storage</p></li>
<li><p>Ubuntu 21.04 Installed</p></li>
</ul>
<p>If you do not have a host for this server, here are some recommendations:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://marketplace.digitalocean.com/apps/netmaker">DigitalOcean (preferred)</a></p></li>
<li><p><a class="reference external" href="https://www.linode.com">Linode</a></p></li>
<li><p><a class="reference external" href="https://www.keepsec.ca">KeepSec</a></p></li>
<li><p><a class="reference external" href="https://aws.amazon.com">AWS</a></p></li>
<li><p><a class="reference external" href="https://azure.microsoft.com">Azure</a></p></li>
<li><p><a class="reference external" href="https://cloud.google.com">GCP</a></p></li>
<li><p>We <strong>do not</strong> recommend Oracle Cloud. There are known issues with their network configuration.</p></li>
</ul>
</section>
<section id="domain">
<h3 id="domain">Domain<a class="headerlink" href="#domain" title="Permalink to this headline">¶</a></h3>
<p>Your server will host several services (netmaker server, UI, etc.) each of which requires a dedicated, public subdomain. Here are some recommendations:</p>
<ul class="simple">
<li><p>Use a publicly owned domain (e.x. example.com, mysite.biz)</p></li>
<li><p>Designate a subdomain (e.g. netmaker.example.com) for netmaker’s services (e.g. dashboard.netmaker.example.com)</p></li>
<li><p>Make sure you have permission and access to modify DNS records for your domain (e.x: Route53)</p></li>
<li><p><strong>Note on Cloudflare:</strong> Many of our users use Cloudflare for DNS. Cloudflare has limitations on subdomains you must be aware of, which can cause issues once Netmaker is deployed. Cloudflare will also proxy connections, which MQ does not like. This can be disabled in the Cloudflare dashboard. If setting up your Netmaker server using Cloudflare for DNS, be aware that the configuration of Cloudflare may cause problems with Netmaker which must be resolved, and at this point, Netmaker is not providing guidance on this setup.</p></li>
</ul>
</section>
</section>
<section id="prepare-dns">
<h2 id="prepare-dns">1. Prepare DNS<a class="headerlink" href="#prepare-dns" title="Permalink to this headline">¶</a></h2>
<p>Create a wildcard A record pointing to the public IP of your VM. As an example, *.netmaker.example.com. Alternatively, create records for these specific subdomains:</p>
<ul class="simple">
<li><p>dashboard.domain</p></li>
<li><p>api.domain</p></li>
<li><p>broker.domain</p></li>
</ul>
<p>If deploying Pro, you will also need records for the following:IsStatic</p>
<ul class="simple">
<li><p>grafana.domain</p></li>
<li><p>prometheus.domain</p></li>
<li><p>netmaker-exporter.domain</p></li>
</ul>
</section>
<section id="install-dependencies">
<h2 id="install-dependencies">2. Install Dependencies<a class="headerlink" href="#install-dependencies" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ssh</span> <span class="n">root</span><span class="nd">@your</span><span class="o">-</span><span class="n">host</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">docker</span><span class="o">.</span><span class="n">io</span> <span class="n">docker</span><span class="o">-</span><span class="n">compose</span>
</pre></div>
</div>
<p>At this point you should have all the system dependencies you need.</p>
</section>
<section id="open-firewall">
<h2 id="open-firewall">3. Open Firewall<a class="headerlink" href="#open-firewall" title="Permalink to this headline">¶</a></h2>
<p>Make sure firewall settings are set for Netmaker both on the VM and with your cloud security groups (AWS, GCP, etc).</p>
<p>Make sure the following ports are open both on the VM and in the cloud security groups:</p>
<ul class="simple">
<li><p><strong>443, 80 (tcp):</strong> for Caddy, which proxies the Dashboard (UI), REST API (Netmaker Server), and Broker (MQTT)</p></li>
<li><p><strong>51821-518XX (udp):</strong> for WireGuard - Netmaker needs one port per network, starting with 51821, so open up a range depending on the number of networks you plan on having. For instance, 51821-51830.</p></li>
<li><p><strong>8085 (exporter Pro):</strong> If you are building a Pro server, you need this port open.</p></li>
<li><p><strong>1883, 8883 8083, 18083 (if using EMQX):</strong> We use two different types of brokers. There is Mosquitto or EMQX. if you are setting up EMQX, these four need to be open for MQTT, SSL MQTT, web sockets, and the EMQX dashbaord/REST api.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">ufw</span> <span class="n">allow</span> <span class="n">proto</span> <span class="n">tcp</span> <span class="kn">from</span> <span class="nn">any</span> <span class="n">to</span> <span class="nb">any</span> <span class="n">port</span> <span class="mi">443</span>
<span class="n">sudo</span> <span class="n">ufw</span> <span class="n">allow</span> <span class="n">proto</span> <span class="n">tcp</span> <span class="kn">from</span> <span class="nn">any</span> <span class="n">to</span> <span class="nb">any</span> <span class="n">port</span> <span class="mi">80</span>
<span class="n">sudo</span> <span class="n">ufw</span> <span class="n">allow</span> <span class="n">proto</span> <span class="n">tcp</span> <span class="kn">from</span> <span class="nn">any</span> <span class="n">to</span> <span class="nb">any</span> <span class="n">port</span> <span class="mi">3479</span>
<span class="n">sudo</span> <span class="n">ufw</span> <span class="n">allow</span> <span class="n">proto</span> <span class="n">tcp</span> <span class="kn">from</span> <span class="nn">any</span> <span class="n">to</span> <span class="nb">any</span> <span class="n">port</span> <span class="mi">8089</span>
<span class="n">sudo</span> <span class="n">ufw</span> <span class="n">allow</span> <span class="mi">51821</span><span class="p">:</span><span class="mi">51830</span><span class="o">/</span><span class="n">udp</span>
</pre></div>
</div>
<p>It is also important to make sure the server does not block forwarding traffic (it will do this by default on some providers). To ensure traffic will be forwarded:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">iptables</span> <span class="o">--</span><span class="n">policy</span> <span class="n">FORWARD</span> <span class="n">ACCEPT</span>
</pre></div>
</div>
<dl class="simple">
<dt><strong>Again, based on your cloud provider, you may additionally need to set inbound security rules for your server (for instance, on AWS). This will be dependent on your cloud provider. Be sure to check before moving on:</strong></dt><dd><ul class="simple">
<li><p>allow 443/tcp from all</p></li>
<li><p>allow 80/tcp from all</p></li>
<li><p>allow 3479/tcp from all</p></li>
<li><p>allow 8089/tcp from all</p></li>
<li><p>allow 51821-51830/udp from all</p></li>
</ul>
</dd>
</dl>
</section>
<section id="prepare-mq">
<h2 id="prepare-mq">4. Prepare MQ<a class="headerlink" href="#prepare-mq" title="Permalink to this headline">¶</a></h2>
<p>You must retrieve the MQ configuration file for Mosquitto and the wait script.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="o">-</span><span class="n">O</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">mosquitto</span><span class="o">.</span><span class="n">conf</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">gravitl</span><span class="o">/</span><span class="n">netmaker</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">docker</span><span class="o">/</span><span class="n">mosquitto</span><span class="o">.</span><span class="n">conf</span>
<span class="n">wget</span> <span class="o">-</span><span class="n">q</span> <span class="o">-</span><span class="n">O</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">wait</span><span class="o">.</span><span class="n">sh</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">gravitl</span><span class="o">/</span><span class="n">netmaker</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">docker</span><span class="o">/</span><span class="n">wait</span><span class="o">.</span><span class="n">sh</span>
<span class="n">chmod</span> <span class="o">+</span><span class="n">x</span> <span class="n">wait</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</section>
<section id="install-netmaker">
<h2 id="install-netmaker">5. Install Netmaker<a class="headerlink" href="#install-netmaker" title="Permalink to this headline">¶</a></h2>
<section id="prepare-docker-compose">
<h3 id="prepare-docker-compose">Prepare Docker Compose<a class="headerlink" href="#prepare-docker-compose" title="Permalink to this headline">¶</a></h3>
<p>As of 0.20.0, our docker-compose and Caddyfile now contains references to a netmaker.env file. This will cut down on repetitive entries like inserting your base domain multiple times. You only insert it once in your netmaker.env file and the backend handles placing it in the right places. The EMQX and Pro docker-composes are now extensions of the regular docker-compose file, so switching to Pro or EMQX doesn’t involve recreating an entire docker-compose file.</p>
<p>Get the base docker-compose and Caddyfile.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">gravitl</span><span class="o">/</span><span class="n">netmaker</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">compose</span><span class="o">/</span><span class="n">docker</span><span class="o">-</span><span class="n">compose</span><span class="o">.</span><span class="n">yml</span>
<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">gravitl</span><span class="o">/</span><span class="n">netmaker</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">docker</span><span class="o">/</span><span class="n">Caddyfile</span>
</pre></div>
</div>
<p>If you plan on using a Professional server (Pro), then you will need to grab the Caddyfile-pro file instead. There will be more Pro related instructions below in “Extra Steps for Pro”.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">gravitl</span><span class="o">/</span><span class="n">netmaker</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">docker</span><span class="o">/</span><span class="n">Caddyfile</span><span class="o">-</span><span class="n">pro</span>
</pre></div>
</div>
<p>You can grab the netmaker.env file here.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">gravitl</span><span class="o">/</span><span class="n">netmaker</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">netmaker</span><span class="o">.</span><span class="n">default</span><span class="o">.</span><span class="n">env</span>
<span class="n">cp</span> <span class="n">netmaker</span><span class="o">.</span><span class="n">default</span><span class="o">.</span><span class="n">env</span> <span class="n">netmaker</span><span class="o">.</span><span class="n">env</span>
</pre></div>
</div>
<p>You can then use a text editor like vim or nano to go in there and fill out the fields. There is an example below to reference. You can get your ip with the command <code class="docutils literal notranslate"><span class="pre">ip</span> <span class="pre">route</span> <span class="pre">get</span> <span class="pre">1</span> <span class="pre">|</span> <span class="pre">sed</span> <span class="pre">-n</span> <span class="pre">'s/^.*src</span> <span class="pre">\([0-9.]*\)</span> <span class="pre">.*$/\1/p'</span></code>. You can also generate random strings for the master key and MQ passwords with the command <code class="docutils literal notranslate"><span class="pre">tr</span> <span class="pre">-dc</span> <span class="pre">A-Za-z0-9</span> <span class="pre">&lt;/dev/urandom</span> <span class="pre">|</span> <span class="pre">head</span> <span class="pre">-c</span> <span class="pre">30</span> <span class="pre">;</span> <span class="pre">echo</span> <span class="pre">''</span></code> or you can enter them manually if desired. For the base domain again, we advise you use your own domain, because nip.io can hit rate limiting easily from the high volume when obtaining certificates. If you do want to use nip.io, just enter <code class="docutils literal notranslate"><span class="pre">nm.&lt;YOUR_IP_WITH_DASHES_INSTEAD_OF_DOTS&gt;.nip.io</span></code>.</p>
<div class="highlight-cfg notranslate"><div class="highlight"><pre><span></span><span class="c1"># Email used for SSL certificates</span><span class="w"></span>
<span class="na">NM_EMAIL</span><span class="o">=</span><span class="s">example@email.com</span><span class="w"></span>
<span class="c1"># The base domain of netmaker</span><span class="w"></span>
<span class="na">NM_DOMAIN</span><span class="o">=</span><span class="s">nm.123-456-789-012.nip.io</span><span class="w"></span>
<span class="c1"># Public IP of machine</span><span class="w"></span>
<span class="na">SERVER_HOST</span><span class="o">=</span><span class="s">&lt;YOUR_IP_ADDRESS&gt;</span><span class="w"></span>
<span class="c1"># The admin master key for accessing the API. Change this in any production installation.</span><span class="w"></span>
<span class="na">MASTER_KEY</span><span class="o">=</span><span class="s">&lt;RANDOM_STRING&gt;</span><span class="w"></span>
<span class="c1"># The username to set for MQ access</span><span class="w"></span>
<span class="na">MQ_USERNAME</span><span class="o">=</span><span class="s">&lt;EXAMPLE_USERNAME&gt;</span><span class="w"></span>
<span class="c1"># The password to set for MQ access</span><span class="w"></span>
<span class="na">MQ_PASSWORD</span><span class="o">=</span><span class="s">&lt;EXAMPLE_PASSWORD&gt;</span><span class="w"></span>
<span class="c1"># Specify the type of server to install. Use pro for professional and ce for community edition</span><span class="w"></span>
<span class="na">INSTALL_TYPE</span><span class="o">=</span><span class="s">ce</span><span class="w"></span>
<span class="c1"># The next two are for Professional edition. You can find that info below on "Extra steps for Pro"</span><span class="w"></span>
<span class="na">NETMAKER_TENANT_ID</span><span class="o">=</span><span class="w"> </span><span class="s">(for Pro version)</span><span class="w"></span>
<span class="na">LICENSE_KEY</span><span class="o">=</span><span class="w"> </span><span class="s">(for Pro version)</span><span class="w"></span>
<span class="c1"># The version for the netmaker and netmaker-ui servers. current version is v0.20.2.</span><span class="w"></span>
<span class="c1"># Some versions of docker may try to include quotation marks in this reference, so don't put them in.</span><span class="w"></span>
<span class="na">SERVER_IMAGE_TAG</span><span class="o">=</span><span class="s">v0.20.2</span><span class="w"></span>
<span class="na">UI_IMAGE_TAG</span><span class="o">=</span><span class="s">v0.20.2</span><span class="w"></span>
<span class="c1"># used for HA - identifies this server vs other servers</span><span class="w"></span>
<span class="na">NODE_ID</span><span class="o">=</span><span class="s">"netmaker-server-1"</span><span class="w"></span>
<span class="na">METRICS_EXPORTER</span><span class="o">=</span><span class="s">"off" (turn on for Pro)</span><span class="w"></span>
<span class="na">PROMETHEUS</span><span class="o">=</span><span class="s">"off"  (turn on for Pro)</span><span class="w"></span>
<span class="c1"># Enables DNS Mode, meaning all nodes will set hosts file for private dns settings</span><span class="w"></span>
<span class="na">DNS_MODE</span><span class="o">=</span><span class="s">"on"</span><span class="w"></span>
<span class="c1"># Enable auto update of netclient ? ENUM:- enabled,disabled | default=enabled</span><span class="w"></span>
<span class="na">NETCLIENT_AUTO_UPDATE</span><span class="o">=</span><span class="s">"enabled"</span><span class="w"></span>
<span class="c1"># The HTTP API port for Netmaker. Used for API calls / communication from front end.</span><span class="w"></span>
<span class="c1"># If changed, need to change port of BACKEND_URL for netmaker-ui.</span><span class="w"></span>
<span class="na">API_PORT</span><span class="o">=</span><span class="s">"8081"</span><span class="w"></span>
<span class="na">EXPORTER_API_PORT</span><span class="o">=</span><span class="s">"8085"</span><span class="w"></span>
<span class="c1"># The "allowed origin" for API requests. Change to restrict where API requests can come from with comma-separated</span><span class="w"></span>
<span class="c1"># URLs. ex:- https://dashboard.netmaker.domain1.com,https://dashboard.netmaker.domain2.com</span><span class="w"></span>
<span class="na">CORS_ALLOWED_ORIGIN</span><span class="o">=</span><span class="s">"*"</span><span class="w"></span>
<span class="c1"># Show keys permanently in UI (until deleted) as opposed to 1-time display.</span><span class="w"></span>
<span class="na">DISPLAY_KEYS</span><span class="o">=</span><span class="s">"on"</span><span class="w"></span>
<span class="c1"># Database to use - sqlite, postgres, or rqlite</span><span class="w"></span>
<span class="na">DATABASE</span><span class="o">=</span><span class="s">"sqlite"</span><span class="w"></span>
<span class="c1"># The address of the mq server. If running from docker compose it will be "mq". Otherwise, need to input address.</span><span class="w"></span>
<span class="c1"># If using "host networking", it will find and detect the IP of the mq container.</span><span class="w"></span>
<span class="na">SERVER_BROKER_ENDPOINT</span><span class="o">=</span><span class="s">"ws://mq:1883"</span><span class="w"></span>
<span class="c1"># The reachable port of STUN on the server</span><span class="w"></span>
<span class="na">STUN_PORT</span><span class="o">=</span><span class="s">"3478"</span><span class="w"></span>
<span class="c1"># Logging verbosity level - 1, 2, or 3</span><span class="w"></span>
<span class="na">VERBOSITY</span><span class="o">=</span><span class="s">"1"</span><span class="w"></span>
<span class="c1"># If ON, all new clients will enable proxy by default</span><span class="w"></span>
<span class="c1"># If OFF, all new clients will disable proxy by default</span><span class="w"></span>
<span class="c1"># If AUTO, stick with the existing logic for NAT detection</span><span class="w"></span>
<span class="c1"># This setting is no longer available from v0.20.5</span><span class="w"></span>
<span class="na">DEFAULT_PROXY_MODE</span><span class="o">=</span><span class="s">"off"</span><span class="w"></span>
<span class="na">DEBUG_MODE</span><span class="o">=</span><span class="s">"off"</span><span class="w"></span>
<span class="c1"># Enables the REST backend (API running on API_PORT at SERVER_HTTP_HOST).</span><span class="w"></span>
<span class="c1"># Change to "off" to turn off.</span><span class="w"></span>
<span class="na">REST_BACKEND</span><span class="o">=</span><span class="s">"on"</span><span class="w"></span>
<span class="c1"># If turned "on", Server will not set Host based on remote IP check.</span><span class="w"></span>
<span class="c1"># This is already overridden if SERVER_HOST is set. Turned "off" by default.</span><span class="w"></span>
<span class="na">DISABLE_REMOTE_IP_CHECK</span><span class="o">=</span><span class="s">"off"</span><span class="w"></span>
<span class="c1"># Whether or not to send telemetry data to help improve Netmaker. Switch to "off" to opt out of sending telemetry.</span><span class="w"></span>
<span class="na">TELEMETRY</span><span class="o">=</span><span class="s">"on"</span><span class="w"></span>
<span class="c1">###</span><span class="w"></span>
<span class="c1">#</span><span class="w"></span>
<span class="c1"># OAuth section</span><span class="w"></span>
<span class="c1">#</span><span class="w"></span>
<span class="c1">###</span><span class="w"></span>
<span class="c1"># "&lt;azure-ad|github|google|oidc&gt;"</span><span class="w"></span>
<span class="na">AUTH_PROVIDER</span><span class="o">=</span><span class="w"></span>
<span class="c1"># "&lt;client id of your oauth provider&gt;"</span><span class="w"></span>
<span class="na">CLIENT_ID</span><span class="o">=</span><span class="w"></span>
<span class="c1"># "&lt;client secret of your oauth provider&gt;"</span><span class="w"></span>
<span class="na">CLIENT_SECRET</span><span class="o">=</span><span class="w"></span>
<span class="c1"># "https://dashboard.&lt;netmaker base domain&gt;"</span><span class="w"></span>
<span class="na">FRONTEND_URL</span><span class="o">=</span><span class="w"></span>
<span class="c1"># "&lt;only for azure, you may optionally specify the tenant for the OAuth&gt;"</span><span class="w"></span>
<span class="na">AZURE_TENANT</span><span class="o">=</span><span class="w"></span>
<span class="c1"># https://oidc.yourprovider.com - URL of oidc provider</span><span class="w"></span>
<span class="na">OIDC_ISSUER</span><span class="o">=</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="extra-steps-for-pro">
<h3 id="extra-steps-for-pro">Extra Steps for Pro<a class="headerlink" href="#extra-steps-for-pro" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>Visit <a class="reference external" href="https://app.netmaker.io">https://app.netmaker.io</a> to create your account on the Netmaker SaaS platform.</p></li>
<li><p>Create a tenant of type <code class="docutils literal notranslate"><span class="pre">self-hosted</span></code> to obtain a license key. more details in <a class="reference internal" href="pro/pro-setup.html"><span class="doc">Netmaker Professional setup</span></a></p></li>
<li><p>Retrieve Tenant ID and license key from the tenant’s settings tab.</p></li>
<li><p>Place the licence key and tenant ID in the netmaker.env file.</p></li>
<li><p>In the netmaker.env file, change the METRICS_EXPORTER and PROMETHEUS from off to on.</p></li>
<li><p>Grab the docker-compose.pro extension file from the repo and change its name to docker-compose.override.yml.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">gravitl</span><span class="o">/</span><span class="n">netmaker</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">compose</span><span class="o">/</span><span class="n">docker</span><span class="o">-</span><span class="n">compose</span><span class="o">.</span><span class="n">pro</span><span class="o">.</span><span class="n">yml</span>
</pre></div>
</div>
<p>You will not need to make any changes to this file. It will reference the current netmaker.env file.</p>
<p>Then run</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ln</span> <span class="o">-</span><span class="n">fs</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">netmaker</span><span class="o">.</span><span class="n">env</span> <span class="o">/</span><span class="n">root</span><span class="o">/.</span><span class="n">env</span>
</pre></div>
</div>
</section>
</section>
<section id="start-netmaker">
<h2 id="start-netmaker">6. Start Netmaker<a class="headerlink" href="#start-netmaker" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">docker-compose</span> <span class="pre">-f</span> <span class="pre">docker-compose.yml</span> <span class="pre">up</span> <span class="pre">-d</span> <span class="pre">--force-recreate</span></code></p>
<p>navigate to dashboard.&lt;your base domain&gt; to begin using Netmaker.</p>
<p>To troubleshoot issues, start with:</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">logs</span> <span class="pre">netmaker</span></code></p>
<p>Or check out the <a class="reference internal" href="troubleshoot.html"><span class="doc">troubleshoooting docs</span></a>.</p>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="install.html" title="Install"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> "Previous" </span> Install </span>
              </div>
            </a>
          
          
            <a href="netclient.html" title="Netclient"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> "Next" </span> Netclient </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2024, Netmaker Inc..
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.3.2.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Integrating Non-native Devices &#8212; Netmaker 0.24.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/material.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="External Guides" href="usage.html" />
    <link rel="prev" title="How-to-Guides" href="how-to-guides.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=blue data-md-color-accent=teal>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#integrating-non-native-devices" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="index.html" title="Netmaker 0.24.1 documentation"
           class="md-header-nav__button md-logo">
          
            <i class="md-icon">&#xe869</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Netmaker Docs</span>
          <span class="md-header-nav__topic"> Integrating Non-native Devices </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder=""Search""
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/gravitl/netmaker/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Netmaker
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = ""versions.json"",
        target_loc = "../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">Netmaker 0.24.1 documentation</a></li>
          <li class="md-tabs__item"><a href="how-to-guides.html" class="md-tabs__link">How-to-Guides</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="index.html" title="Netmaker 0.24.1 documentation" class="md-nav__button md-logo">
      
        <i class="md-icon">&#xe869</i>
      
    </a>
    <a href="index.html"
       title="Netmaker 0.24.1 documentation">Netmaker Docs</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/gravitl/netmaker/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Netmaker
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="about.html" class="md-nav__link">About</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="getting-started.html" class="md-nav__link">Getting Started</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="features.html" class="md-nav__link">Features</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pro/index.html" class="md-nav__link">Netmaker Professional</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="upgrades.html" class="md-nav__link">Upgrades</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="how-to-guides.html" class="md-nav__link">How-to-Guides</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Integrating Non-native Devices </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Integrating Non-native Devices</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#integrating-non-native-devices--page-root" class="md-nav__link">Integrating Non-native Devices</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#introduction" class="md-nav__link">Introduction</a>
        </li>
        <li class="md-nav__item"><a href="#generating-a-wireguard-configuration-file-on-remote-access-gateway" class="md-nav__link">Generating a WireGuard Configuration File on Remote Access Gateway</a>
        </li>
        <li class="md-nav__item"><a href="#routers-and-firewall-appliances-virtual-or-bare-metal" class="md-nav__link">Routers and Firewall Appliances (Virtual or Bare metal)</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pfsense" class="md-nav__link">1) pfSense</a>
        </li>
        <li class="md-nav__item"><a href="#opnsense" class="md-nav__link">2) OPNsense</a>
        </li>
        <li class="md-nav__item"><a href="#mikrotik" class="md-nav__link">3) MikroTik</a>
        </li>
        <li class="md-nav__item"><a href="#openwrt" class="md-nav__link">4) OpenWrt</a>
        </li>
        <li class="md-nav__item"><a href="#other-routers" class="md-nav__link">5) Other routers</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#internet-of-things-iot-devices" class="md-nav__link">Internet of Things (IoT Devices)</a>
        </li>
        <li class="md-nav__item"><a href="#other-devices" class="md-nav__link">Other Devices</a>
        </li>
        <li class="md-nav__item"><a href="#disclaimer" class="md-nav__link">Disclaimer</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="usage.html" class="md-nav__link">External Guides</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="references.html" class="md-nav__link">References</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="license.html" class="md-nav__link">License</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="conduct.html" class="md-nav__link">Code of Conduct</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#integrating-non-native-devices--page-root" class="md-nav__link">Integrating Non-native Devices</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#introduction" class="md-nav__link">Introduction</a>
        </li>
        <li class="md-nav__item"><a href="#generating-a-wireguard-configuration-file-on-remote-access-gateway" class="md-nav__link">Generating a WireGuard Configuration File on Remote Access Gateway</a>
        </li>
        <li class="md-nav__item"><a href="#routers-and-firewall-appliances-virtual-or-bare-metal" class="md-nav__link">Routers and Firewall Appliances (Virtual or Bare metal)</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#pfsense" class="md-nav__link">1) pfSense</a>
        </li>
        <li class="md-nav__item"><a href="#opnsense" class="md-nav__link">2) OPNsense</a>
        </li>
        <li class="md-nav__item"><a href="#mikrotik" class="md-nav__link">3) MikroTik</a>
        </li>
        <li class="md-nav__item"><a href="#openwrt" class="md-nav__link">4) OpenWrt</a>
        </li>
        <li class="md-nav__item"><a href="#other-routers" class="md-nav__link">5) Other routers</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#internet-of-things-iot-devices" class="md-nav__link">Internet of Things (IoT Devices)</a>
        </li>
        <li class="md-nav__item"><a href="#other-devices" class="md-nav__link">Other Devices</a>
        </li>
        <li class="md-nav__item"><a href="#disclaimer" class="md-nav__link">Disclaimer</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="integrating-non-native-devices">
<span id="id1"></span><h1 id="integrating-non-native-devices--page-root">Integrating Non-native Devices<a class="headerlink" href="#integrating-non-native-devices--page-root" title="Permalink to this headline">¶</a></h1>
<section id="introduction">
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Netmaker manages WireGuard configurations through the Netclient and the Remote Access Client (RAC) installed on the hosts and on the external clients respectively. Basically Netmaker makes WireGuard configurations, which are inherently static, dynamic. As you setup and change your network, Netmaker propagates these changes in the configuration to the affected machines installed with either Netclient or RAC.</p>
<p>However in some cases, it might not be ideal or even possible to install Netclient or RAC on some of your machines/devices. In these cases, Netmaker will rely upon your intervention to install WireGuard on these machines/devices and then to manually set up or change their WireGuard configurations whenever necessary. Basically, you just need to get the current WireGuard configuration (or VPN config files) from your Netmaker Remote Access Gateway and then stick it to your device in order for it to connect to your Netmaker network.</p>
</section>
<section id="generating-a-wireguard-configuration-file-on-remote-access-gateway">
<h2 id="generating-a-wireguard-configuration-file-on-remote-access-gateway">Generating a WireGuard Configuration File on Remote Access Gateway<a class="headerlink" href="#generating-a-wireguard-configuration-file-on-remote-access-gateway" title="Permalink to this headline">¶</a></h2>
<p>Netmaker allows you to generate and manage your VPN configuration files. For instructions on how to make a node a Remote Access Gateway and on how to create/generate VPN configuration files, please refer to the “Remote Access Gateway/External Clients” section under the “How-to-Guides”.</p>
<p>You can also get the WireGuard VPN configuration by following these steps:</p>
<ol class="arabic simple">
<li><p>Navigate to your network’s Remote Access tab. You should see the Gateways table to the left-hand side and then the VPN Config Files table to the right-hand side of the page</p></li>
<li><p>If you have multiple gateways, select the specific one by clicking on it if it hasn’t been selected already</p></li>
<li><p>If necessary, find the VPN configuration by inputting its name in the Search box</p></li>
<li><p>Once you’ve located the configuration file, hover over or click on its ‘kebab’ icon to the right-hand side corner of the row. A context menu should show up similar to the screenshot below</p></li>
</ol>
<a class="reference internal image-reference" href="_images/integration-get-config.jpg"><img alt="Get Client Config" class="align-center" src="_images/integration-get-config.jpg" style="width: 80%;"/></a>
<ol class="arabic simple" start="5">
<li><p>Now you can view and copy the configuration file by clicking on the ‘View Config’ option. Or you can click on the ‘Download’ option to get a copy of the configuration file</p></li>
</ol>
<a class="reference internal image-reference" href="_images/integration-sample-config.jpg"><img alt="Sample Client Config" class="align-center" src="_images/integration-sample-config.jpg" style="width: 80%;"/></a>
<p>Once you have the configuration information or the configuration file, you can now stick it to your router, IoT, or other edge devices.</p>
</section>
<section id="routers-and-firewall-appliances-virtual-or-bare-metal">
<h2 id="routers-and-firewall-appliances-virtual-or-bare-metal">Routers and Firewall Appliances (Virtual or Bare metal)<a class="headerlink" href="#routers-and-firewall-appliances-virtual-or-bare-metal" title="Permalink to this headline">¶</a></h2>
<p>While Netclient can be installed on some routers and firewall appliances after which you can then configure as egress gateways, it is generally ideal to use these devices’ built-in VPN feature for seamless integration. Since most modern VPN routers and firewalls today support WireGuard, they can connect to a Netmaker network as an external client, after which you can then responsibly expose the resources behind them by inputting specific IP address ranges in the ‘Additional Addresses’ field. For more information on the Egressing External Clients, please refer to this link: <a class="reference external" href="https://docs.netmaker.io/egress-gateway.html#egressing-external-clients">https://docs.netmaker.io/egress-gateway.html#egressing-external-clients</a>.</p>
<a class="reference internal image-reference" href="_images/integration-config-additional-addresses.jpg"><img alt="Client additional IP addresses range" class="align-center" src="_images/integration-config-additional-addresses.jpg" style="width: 80%;"/></a>
<p>The general guidelines for integrating routers and firewall appliances (FWA) to Netmaker are the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>Before doing any further configuration, take note of your current firmware version and back up the current configuration settings</p></li>
<li><p>Upgrade your firmware if necessary</p></li>
<li><p>Install WireGuard via your router’s or FWA’s Package Manager. Usually this can be done from its web interface (GUI) instead of from its shell (CLI)</p></li>
<li><p>Input the VPN configuration information from Netmaker; or upload the configuration file if your device supports it</p></li>
<li><p>If necessary, create a routing entry for the WireGuard tunnel interface</p></li>
<li><p>Create tight and specific firewall rules for traffic going in and out between the VPN interface and your LAN [or depending on your use case, your specific device, interface/port, VLAN, DMZ, WAN, etc.]</p></li>
</ul>
</div></blockquote>
<section id="pfsense">
<h3 id="pfsense">1) pfSense<a class="headerlink" href="#pfsense" title="Permalink to this headline">¶</a></h3>
<p>This guide will help you set up WireGuard on pfSense 2.7.2. We will connect to a Netmaker network via a Remote Access Gateway</p>
<ol class="upperalpha simple">
<li><p>install WireGuard using the Package Manager in System -&gt; Package Manager -&gt; Available Packages</p></li>
</ol>
<a class="reference internal image-reference" href="_images/integration-pfsense-pkgmgr.jpg"><img alt="pfSense Package Manager" class="align-center" src="_images/integration-pfsense-pkgmgr.jpg" style="width: 80%;"/></a>
<ol class="upperalpha simple" start="2">
<li><p>go to VPN -&gt; WireGuard -&gt; Tunnels, and then create a new WireGuard tunnel using the configuration information provided by Netmaker. Click on the Generate button under the Interface Keys fields before pasting the Private Key (from the configuration file generated by Netmaker). Save or submit the form and then take note of the tunnel interface name</p></li>
</ol>
<a class="reference internal image-reference" href="_images/integration-pfsense-tunnel-interface.jpg"><img alt="pfSense Tunnel Configuration" class="align-center" src="_images/integration-pfsense-tunnel-interface.jpg" style="width: 80%;"/></a>
<ol class="upperalpha simple" start="3">
<li><p>go to VPN -&gt; WireGuard -&gt; Peers, and then create a peer. Input the necessary configuration infomation similar to what is shown in the image below</p></li>
</ol>
<a class="reference internal image-reference" href="_images/integration-pfsense-peer.jpg"><img alt="pfSense Peer Configuration" class="align-center" src="_images/integration-pfsense-peer.jpg" style="width: 80%;"/></a>
<ol class="upperalpha simple" start="4">
<li><p>enable WireGuard in VPN -&gt; WireGuard -&gt; Settings, and then click on the Apply Changes button. Make sure that the ‘handshake’ icon is green under the Status tab before proceeding any further</p></li>
</ol>
<a class="reference internal image-reference" href="_images/integration-pfsense-enable-wg.jpg"><img alt="pfSense enable WireGuard" class="align-center" src="_images/integration-pfsense-enable-wg.jpg" style="width: 80%;"/></a>
<ol class="upperalpha simple" start="5">
<li><p>go to Interfaces -&gt; Assignments, and then assign or add a new interface for the WireGuard tunnel you created in Step 2. Take note of the interface name (say OPT1)</p></li>
</ol>
<a class="reference internal image-reference" href="_images/integration-pfsense-assign-if.jpg"><img alt="pfSense assign WireGuard tunnel interface" class="align-center" src="_images/integration-pfsense-assign-if.jpg" style="width: 80%;"/></a>
<ol class="upperalpha simple" start="6">
<li><p>go to Interfaces -&gt; [OPT1], and then tick the ‘Enable interface’ checkbox, input the MTU, static IP address, and the Netmaker network prefix</p></li>
</ol>
<a class="reference internal image-reference" href="_images/integration-pfsense-enable-if-init.jpg"><img alt="pfSense go to the WireGuard tunnel interface" class="align-center" src="_images/integration-pfsense-enable-if-init.jpg" style="width: 80%;"/></a>
<a class="reference internal image-reference" href="_images/integration-pfsense-enable-if.jpg"><img alt="pfSense enable WireGuard tunnel interface" class="align-center" src="_images/integration-pfsense-enable-if.jpg" style="width: 80%;"/></a>
<p>If you’re trying to connect to a Netmaker Internet Gateway, then click on the ‘Add a new gateway’ button. Depending on your use case, you may tick the Default Gateway checkbox so that all internet traffic will route through the Netmaker Internet Gateway. Then go to System -&gt; General Setup and, [again] depending on your use case, select the Netmaker Internet Gateway in the DNS Server Settings so that domain name resolution traffic will pass through it instead of the other gateways</p>
<a class="reference internal image-reference" href="_images/integration-pfsense-if-internet-gw.jpg"><img alt="pfSense create an internet gateway" class="align-center" src="_images/integration-pfsense-if-internet-gw.jpg" style="width: 80%;"/></a>
<ol class="upperalpha simple" start="7">
<li><p>If you just need to connect to an Internet Gateway, you don’t need to do this step. Otherwise, create a Firewall rule allowing traffic from the Netmaker network to the target resource. In this guide we are going to allow ICMP traffic to the LAN so that we can do pings. Go to Firewall -&gt; Rules -&gt; [OPT1] and add a rule similar to what is shown in the screenshot below</p></li>
</ol>
<a class="reference internal image-reference" href="_images/integration-pfsense-fw-init.jpg"><img alt="pfSense add firewall rule" class="align-center" src="_images/integration-pfsense-fw-init.jpg" style="width: 80%;"/></a>
<a class="reference internal image-reference" href="_images/integration-pfsense-fw.jpg"><img alt="pfSense add firewall rule - form" class="align-center" src="_images/integration-pfsense-fw.jpg" style="width: 80%;"/></a>
<p>After saving the firewall rule, nodes from your netmaker network should now be able to ping the egress ranges you’ve specified, and vice versa. Edit the firewall rule above or create another one specific to your needs.</p>
</section>
<section id="opnsense">
<h3 id="opnsense">2) OPNsense<a class="headerlink" href="#opnsense" title="Permalink to this headline">¶</a></h3>
<p>This guide will help you set up WireGuard on OPNsense 24.1_1. We will connect to a Netmaker network via a Remote Access Gateway:</p>
<ol class="upperalpha simple">
<li><p>WireGuard comes pre-installed on OPNsense 24.1_1. For OPNsense 23.7.12 and below, install WireGuard as a plug-in in System -&gt; Firmware -&gt; Plugins</p></li>
<li><p>go to VPN -&gt; WireGuard -&gt; Settings -&gt; Instances, and then create a new WireGuard tunnel instance using the configuration information provided by Netmaker. Click on the Generate [gear] icon in the Public Key field before pasting the Private Key (from the configuration file generated by Netmaker). Save and then take note of the tunnel interface name</p></li>
</ol>
<a class="reference internal image-reference" href="_images/integration-opnsense-tunnel-interface.jpg"><img alt="OPNsense Tunnel Configuration" class="align-center" src="_images/integration-opnsense-tunnel-interface.jpg" style="width: 80%;"/></a>
<ol class="upperalpha simple" start="3">
<li><p>go to VPN -&gt; WireGuard -&gt; Settings -&gt; Peers, and then create a WireGuard peer using the information provided by Netmaker</p></li>
</ol>
<a class="reference internal image-reference" href="_images/integration-opnsense-peer.jpg"><img alt="OPNsense Peer Configuration" class="align-center" src="_images/integration-opnsense-peer.jpg" style="width: 80%;"/></a>
<ol class="upperalpha simple" start="4">
<li><p>enable WireGuard in VPN -&gt; WireGuard -&gt; Settings -&gt; General. And then click on the Apply Changes button</p></li>
</ol>
<a class="reference internal image-reference" href="_images/integration-opnsense-enable-wg.jpg"><img alt="OPNsense enable WireGuard" class="align-center" src="_images/integration-opnsense-enable-wg.jpg" style="width: 80%;"/></a>
<ol class="upperalpha simple" start="5">
<li><p>go to Interfaces -&gt; Assignments, and then assign or add a new interface for the WireGuard tunnel you created in Step 2. Take note of the interface name (say OPT1)</p></li>
</ol>
<a class="reference internal image-reference" href="_images/integration-opnsense-assign-if.jpg"><img alt="OPNsense assign WireGuard tunnel interface" class="align-center" src="_images/integration-opnsense-assign-if.jpg" style="width: 80%;"/></a>
<ol class="upperalpha simple" start="6">
<li><p>go to Interfaces -&gt; [OPT1], and then tick the ‘Enable interface’ and the ‘Prevent interface removal’ checkboxes</p></li>
</ol>
<a class="reference internal image-reference" href="_images/integration-opnsense-enable-if.jpg"><img alt="OPNsense enable WireGuard tunnel interface" class="align-center" src="_images/integration-opnsense-enable-if.jpg" style="width: 80%;"/></a>
<ol class="upperalpha simple" start="7">
<li><p>Create a route to the Netmaker network by first creating a gateway. Go to System -&gt; Gateways -&gt; Configuration, then click on the add icon and specify the tunnel interface [OPT1] and its IP</p></li>
</ol>
<a class="reference internal image-reference" href="_images/integration-opnsense-add-gw.jpg"><img alt="OPNsense add gateway" class="align-center" src="_images/integration-opnsense-add-gw.jpg" style="width: 80%;"/></a>
<ol class="upperalpha simple" start="8">
<li><p>Add the necessary routing entry. Go to System -&gt; Routes -&gt; Configuration, then click on the ‘add’ icon and specify a route to the Netmaker network via the gateway created in the previous step</p></li>
</ol>
<a class="reference internal image-reference" href="_images/integration-opnsense-add-routing-entry.jpg"><img alt="OPNsense add routing entry" class="align-center" src="_images/integration-opnsense-add-routing-entry.jpg" style="width: 80%;"/></a>
<ol class="upperroman simple">
<li><p>Create a Firewall rule for WireGuard allowing traffic between it and the target resource. In this guide we are going to allow ICMP traffic between WireGuard tunnel interface and the LAN so that we can do pings. Go to Firewall -&gt; Rules -&gt; [OPT1] and add a rule similar to what is shown in the screenshot below</p></li>
</ol>
<a class="reference internal image-reference" href="_images/integration-opnsense-fw.jpg"><img alt="OPNsense add firewall rule - form" class="align-center" src="_images/integration-opnsense-fw.jpg" style="width: 80%;"/></a>
<p>After saving the firewall rule, devices in your LAN should now be able to ping machines in your Netmaker network, and vice versa. Edit the firewall rule above or create one that would suit your needs.</p>
</section>
<section id="mikrotik">
<h3 id="mikrotik">3) MikroTik<a class="headerlink" href="#mikrotik" title="Permalink to this headline">¶</a></h3>
<p>This guide will help you set up WireGuard on MikroTik 7.13.3. We will connect to a Netmaker network via a Remote Access Gateway:</p>
<ol class="upperalpha simple">
<li><p>WireGuard comes pre-installed on MikroTik 7.13.3 so you don’t have to do anything.</p></li>
<li><p>given a sample WireGuard configuration below, you can access MikroTik’s CLI and issue the corresponding commands</p></li>
</ol>
<a class="reference internal image-reference" href="_images/integration-mikrotik-wg-config.jpg"><img alt="Sample WireGuard configuration for MikroTik" class="align-center" src="_images/integration-mikrotik-wg-config.jpg" style="width: 80%;"/></a>
<p>WireGuard interface configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">interface</span><span class="o">/</span><span class="n">wireguard</span>
<span class="n">add</span> <span class="n">name</span><span class="o">=</span><span class="n">wg</span><span class="o">-</span><span class="n">netmaker</span> <span class="n">mtu</span><span class="o">=</span><span class="mi">1420</span> <span class="n">private</span><span class="o">-</span><span class="n">key</span><span class="o">=</span><span class="s2">"iMfHqGANXMJHGMBKwuo89txiU3/9edC20TxWpFtmU2Y="</span>
</pre></div>
</div>
<p>Peer configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">interface</span><span class="o">/</span><span class="n">wireguard</span><span class="o">/</span><span class="n">peers</span>
<span class="n">add</span> <span class="n">allowed</span><span class="o">-</span><span class="n">address</span><span class="o">=</span><span class="mf">10.40.70.0</span><span class="o">/</span><span class="mi">24</span> <span class="n">endpoint</span><span class="o">-</span><span class="n">address</span><span class="o">=</span><span class="mf">188.166.235.45</span> <span class="n">endpoint</span><span class="o">-</span><span class="n">port</span><span class="o">=</span><span class="mi">51821</span> <span class="n">interface</span><span class="o">=</span><span class="n">wg</span><span class="o">-</span><span class="n">netmaker</span> <span class="n">public</span><span class="o">-</span><span class="n">key</span><span class="o">=</span><span class="s2">"GM80g/eeXgkOrk0yYtdhhU73ETHffpojG2Ewd+N4kXI="</span> <span class="n">persistent</span><span class="o">-</span><span class="n">keepalive</span><span class="o">=</span><span class="mi">20</span> <span class="n">client</span><span class="o">-</span><span class="n">dns</span><span class="o">=</span><span class="mf">159.159.159.159</span>
</pre></div>
</div>
<p>IP and routing configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">ip</span><span class="o">/</span><span class="n">address</span>
<span class="n">add</span> <span class="n">address</span><span class="o">=</span><span class="mf">10.40.70.254</span><span class="o">/</span><span class="mi">32</span> <span class="n">interface</span><span class="o">=</span><span class="n">wg</span><span class="o">-</span><span class="n">netmaker</span>
<span class="o">/</span><span class="n">ip</span><span class="o">/</span><span class="n">route</span>
<span class="n">add</span> <span class="n">dst</span><span class="o">-</span><span class="n">address</span><span class="o">=</span><span class="mf">10.40.70.0</span><span class="o">/</span><span class="mi">24</span> <span class="n">gateway</span><span class="o">=</span><span class="n">wg</span><span class="o">-</span><span class="n">netmaker</span>
</pre></div>
</div>
<p>And that’s it. Devices from your LAN should now be able to reach machines in your Netmaker network, and vice versa.</p>
<p>For more information, please refer to this guide from MikroTik’s documentation page: <a class="reference external" href="https://help.mikrotik.com/docs/display/ROS/WireGuard">https://help.mikrotik.com/docs/display/ROS/WireGuard</a>.</p>
<p>Routing internet traffic to a Netmaker Internet Gateway is also possible by adding the necessary firewall NAT rules. Please refer to the MikroTik documentation for more information.</p>
</section>
<section id="openwrt">
<h3 id="openwrt">4) OpenWrt<a class="headerlink" href="#openwrt" title="Permalink to this headline">¶</a></h3>
<p>This guide will help you set up WireGuard on OpenWrt 23.05.2. We will connect to a Netmaker network via a Remote Access Gateway:</p>
<ol class="upperalpha simple">
<li><p>Go to System -&gt; Software. Click on the <cite>Update lists…</cite> button then search for <cite>WireGuard</cite>. Install <cite>WireGuard-tools</cite> and <cite>luci-proto-WireGuard</cite> (for Web GUI). Reboot.</p></li>
</ol>
<a class="reference internal image-reference" href="_images/integration-openwrt-pkgmgr.jpg"><img alt="OpenWrt software manager" class="align-center" src="_images/integration-openwrt-pkgmgr.jpg" style="width: 80%;"/></a>
<ol class="upperalpha simple" start="2">
<li><p>go to Network -&gt; Interfaces, and then add a new WireGuard tunnel interface</p></li>
</ol>
<a class="reference internal image-reference" href="_images/integration-openwrt-assign-if.jpg"><img alt="OpenWrt - create tunnel interface" class="align-center" src="_images/integration-openwrt-assign-if.jpg" style="width: 80%;"/></a>
<ol class="upperalpha simple" start="3">
<li><p>click on the <cite>Load Configuration…</cite>, paste the WireGuard configuration and then click <cite>Import settings</cite></p></li>
</ol>
<a class="reference internal image-reference" href="_images/integration-openwrt-wg-config.jpg"><img alt="OpenWrt - import WireGuard configuration" class="align-center" src="_images/integration-openwrt-wg-config.jpg" style="width: 80%;"/></a>
<ol class="upperalpha simple" start="4">
<li><p>go to the <cite>Peers</cite> tab. Edit the generated peer, tick the <cite>Route Allowed IPs</cite> field. Save and apply the changes made.</p></li>
</ol>
<a class="reference internal image-reference" href="_images/integration-openwrt-wg-peer.jpg"><img alt="OpenWrt - route allowed IPs" class="align-center" src="_images/integration-openwrt-wg-peer.jpg" style="width: 80%;"/></a>
<ol class="upperalpha simple" start="5">
<li><p>go to Status -&gt; WireGuard and make sure that a handshake has taken place. If successful, OpenWrt should be able to reach the Netmaker Remote Access Gateway but not the other way around</p></li>
</ol>
<a class="reference internal image-reference" href="_images/integration-openwrt-wg-status.jpg"><img alt="OpenWrt - WireGuard tunnel status" class="align-center" src="_images/integration-openwrt-wg-status.jpg" style="width: 80%;"/></a>
<ol class="upperalpha simple" start="6">
<li><p>go to Network -&gt; Firewall, and then add a zone allowing traffic between the WireGuard tunnel and the LAN. Please do add your own version of Firewall rule that is tight and specific to your needs. Save and apply the changes made.</p></li>
</ol>
<a class="reference internal image-reference" href="_images/integration-openwrt-wg-fw.jpg"><img alt="OpenWrt - Firewall configuration" class="align-center" src="_images/integration-openwrt-wg-fw.jpg" style="width: 80%;"/></a>
<p>And that’s about it. Routing internet traffic to a Netmaker Internet Gateway is also possible by adding the necessary firewall NAT rules. Please refer to the OpenWrt documentation for more information.</p>
</section>
<section id="other-routers">
<h3 id="other-routers">5) Other routers<a class="headerlink" href="#other-routers" title="Permalink to this headline">¶</a></h3>
<p>Please refer to these links for instructions on how to configure WireGuard:</p>
<blockquote>
<div><ol class="upperalpha simple">
<li><p>TP-Link - <a class="reference external" href="https://www.tp-link.com/fr/support/faq/3772/">https://www.tp-link.com/fr/support/faq/3772/</a></p></li>
<li><p>Asus - <a class="reference external" href="https://www.asus.com/support/faq/1048281/">https://www.asus.com/support/faq/1048281/</a></p></li>
<li><p>GL.iNet - <a class="reference external" href="https://docs.gl-inet.com/router/en/3/tutorials/WireGuard_client/#setup-WireGuard-client">https://docs.gl-inet.com/router/en/3/tutorials/WireGuard_client/#setup-WireGuard-client</a></p></li>
<li><p>Teltonika - <a class="reference external" href="https://wiki.teltonika-networks.com/view/WireGuard_Configuration_Example">https://wiki.teltonika-networks.com/view/WireGuard_Configuration_Example</a></p></li>
<li><p>pcWRT - <a class="reference external" href="https://www.pcwrt.com/2019/12/how-to-set-up-a-WireGuard-vpn-client-connection-on-the-pcwrt-router/">https://www.pcwrt.com/2019/12/how-to-set-up-a-WireGuard-vpn-client-connection-on-the-pcwrt-router/</a></p></li>
<li><p>DD-WRT - <a class="reference external" href="https://windscribe.com/knowledge-base/articles/WireGuard-router-setup-guide-dd-wrt">https://windscribe.com/knowledge-base/articles/WireGuard-router-setup-guide-dd-wrt</a></p></li>
</ol>
</div></blockquote>
</section>
</section>
<section id="internet-of-things-iot-devices">
<h2 id="internet-of-things-iot-devices">Internet of Things (IoT Devices)<a class="headerlink" href="#internet-of-things-iot-devices" title="Permalink to this headline">¶</a></h2>
<p>Please refer to these links for instructions on how to configure WireGuard:</p>
<blockquote>
<div><ol class="upperalpha simple">
<li><p>IOTstack - <a class="reference external" href="https://sensorsiot.github.io/IOTstack/Containers/WireGuard/">https://sensorsiot.github.io/IOTstack/Containers/WireGuard/</a></p></li>
<li><p>Embedded Linux - <a class="reference external" href="https://www.toradex.com/blog/embedded-linux-vpn-application">https://www.toradex.com/blog/embedded-linux-vpn-application</a></p></li>
<li><p>lwIP IP stack - <a class="reference external" href="https://github.com/smartalock/WireGuard-lwip">https://github.com/smartalock/WireGuard-lwip</a></p></li>
</ol>
</div></blockquote>
</section>
<section id="other-devices">
<h2 id="other-devices">Other Devices<a class="headerlink" href="#other-devices" title="Permalink to this headline">¶</a></h2>
<p>For other devices not covered above, please refer to your device’s documentation for instructions on how to install and configure WireGuard.</p>
</section>
<section id="disclaimer">
<h2 id="disclaimer">Disclaimer<a class="headerlink" href="#disclaimer" title="Permalink to this headline">¶</a></h2>
<p>The information provided by us on this how-to guide is for general informational purposes only. All information on this page is provided in good faith, however we make no representation or warranty of any kind, express or implied, regarding the accuracy, adequacy, validity, reliability, availability or completeness of any information on the page.</p>
<p>Under no circumstance shall we have any liability to you for any loss or damage of any kind incurred as a result of the use of this how-to guide or reliance on any information provided on the page. Your use of the how-to guide and your reliance on any information on the page is solely at your own risk.</p>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="how-to-guides.html" title="How-to-Guides"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> "Previous" </span> How-to-Guides </span>
              </div>
            </a>
          
          
            <a href="usage.html" title="External Guides"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> "Next" </span> External Guides </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2024, Netmaker Inc..
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.3.2.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>